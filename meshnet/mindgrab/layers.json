{
  "version": "2.0",
  "metadata": {
    "description": "A model architecture for 256^3 brains with 5 decoders, where dilation in each is structured as 16->8->4->2->1",
    "framework": "tinygrad",
    "input_shape": [1, 256, 256, 256],
    "output_classes": 5
  },
  "preprocessing": {
    "op": "none",
    "params": {}
  },
  "forward_pass": [
    {"op": "conv3d", "params": {"in_channels": 1, "out_channels": 15, "kernel_size": 3, "padding": 16, "stride": 1, "dilation": 16, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15, "affine" : false}},
    {"op": "batch_norm3d", "params": {"num_features": 15, "affine": false}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 8, "stride": 1, "dilation": 8, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15, "affine" : false}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 4, "stride": 1, "dilation": 4, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15, "affine" : false}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 2, "stride": 1, "dilation": 2, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15, "affine" : false}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 1, "stride": 1, "dilation": 1, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 16, "stride": 1, "dilation": 16, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 8, "stride": 1, "dilation": 8, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 4, "stride": 1, "dilation": 4, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 2, "stride": 1, "dilation": 2, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 1, "stride": 1, "dilation": 1, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 16, "stride": 1, "dilation": 16, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 8, "stride": 1, "dilation": 8, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 4, "stride": 1, "dilation": 4, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 2, "stride": 1, "dilation": 2, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 1, "stride": 1, "dilation": 1, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 16, "stride": 1, "dilation": 16, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 8, "stride": 1, "dilation": 8, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 4, "stride": 1, "dilation": 4, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 2, "stride": 1, "dilation": 2, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 1, "stride": 1, "dilation": 1, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 16, "stride": 1, "dilation": 16, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 8, "stride": 1, "dilation": 8, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 4, "stride": 1, "dilation": 4, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 2, "stride": 1, "dilation": 2, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 15, "kernel_size": 3, "padding": 1, "stride": 1, "dilation": 1, "bias": false}},
    {"op": "group_norm", "params": {"num_groups": 15, "num_channels": 15}},
    {"op": "batch_norm3d", "params": {"num_features": 15}},
    {"op": "gelu", "params": {}},
    
    {"op": "conv3d", "params": {"in_channels": 15, "out_channels": 2, "kernel_size": 1, "padding": 0, "stride": 1, "dilation": 1, "bias": false}}

  ],
  "postprocessing": {
    "op": "none",
    "params": {}
  }
}
